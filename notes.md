insert changes to this code ......wait i'll also paste some important notes....

Diffie-Hellman key exchange is a simple way for two private key owning entities to derive a secret shared key between them. All that the two parties need to do is exchange public keys.Once a hop has derived the shared secret with Alice, they can then use that shared secret along with some constants (rho, mu, pad, um and ammag) to derive other keys or byte streams:, what she will do is derive a single ephemeral key pair. The private key of this pair is called the session_key. Alice uses this key to derive all the other ephemeral keys along the path. What is cool about this is that she only has to communicate the very first public ephemeral key to the first hop. That hop will then be able to use that ephemeral key along with its shared secret with Alice to derive the ephemeral key to pass on to the following hop.Since the HMAC can only be derived by the sender, Alice, each HMAC for each hop must be present in the onion from the beginning.if you take a packet and XOR it with a random byte stream, then you get the encrypted form of the packet. Example 4 shows that if you then take that encrypted packet and once again XOR it with the same byte stream, then you are once again left with the clear text.

